       SUBROUTINE VDSS3(X,N1,N2,N3,U,L,A,NA1,NA2,F,FPRIME)
C DRIVER FOR 3D
C X(3)--POINT AT WHICH SPLINE IS TO BE EVALUATED
C N1,N2,N3--NUMBER OF SAMPLES
C U(3)--UPPER BOUND OF INTERVAL
C L(3)--LOWER BOUND OF INTERVAL
C A(NA1,NA2,N3)--SPLINE COEFFICIENTS
C NA1,NA2--ACTUAL FIRST DIMENSION OF A
C F--FUNCTION
C FPRIME(3)--PARTIALS
       INTEGER N1,N2,N3,NA1,NA2,I
       REAL X(3),A(NA1,NA2,N3),F,FPRIME(3),X1(3)
       REAL U(3),L(3),DIST(3)
C ERROR CHECKING
C/6S
C      IF (N1.LE.0) CALL SETERR(14HVDSS3- N1.LE.0,13,1,2)
C      IF (N2.LE.0) CALL SETERR(14HVDSS3- N2.LE.0,13,1,2)
C      IF (N3.LE.0) CALL SETERR(14HVDSS3- N3.LE.0,13,1,2)
C      IF (NA1.LT.N1) CALL SETERR(16HVDSS3- NA1.LT.N1,13,2,2)
C      IF (NA2.LT.N2) CALL SETERR(16HVDSS3- NA2.LT.N2,13,2,2)
C      IF (U(1).LE.L(1)) CALL SETERR(19HVDSS3- U(1).LE.L(1),13,3,2)
C      IF (U(2).LE.L(2)) CALL SETERR(19HVDSS3- U(2).LE.L(2),13,3,2)
C      IF (U(3).LE.L(3)) CALL SETERR(19HVDSS3- U(3).LE.L(3),13,3,2)
C/7S
       IF (N1.LE.0) CALL SETERR('VDSS3- N1.LE.0',13,1,2)
       IF (N2.LE.0) CALL SETERR('VDSS3- N2.LE.0',13,1,2)
       IF (N3.LE.0) CALL SETERR('VDSS3- N3.LE.0',13,1,2)
       IF (NA1.LT.N1) CALL SETERR('VDSS3- NA1.LT.N1',13,2,2)
       IF (NA2.LT.N2) CALL SETERR('VDSS3- NA2.LT.N2',13,2,2)
       IF (U(1).LE.L(1)) CALL SETERR('VDSS3- U(1).LE.L(1)',13,3,2)
       IF (U(2).LE.L(2)) CALL SETERR('VDSS3- U(2).LE.L(2)',13,3,2)
       IF (U(3).LE.L(3)) CALL SETERR('VDSS3- U(3).LE.L(3)',13,3,2)
C/
C SCALE TO UNIT CUBE
       DO 100 I=1,3
              X1(I) = X(I) - L(I)
              DIST(I) = U(I) - L(I)
              X1(I) = X1(I) / DIST(I)
 100   CONTINUE
C CALL SPLINE ROUTINE
       CALL T3UEV(X1,N1,N2,N3,A,NA1,NA2,F,FPRIME(1),FPRIME(2),FPRIME(3))
       DO 110 I=1,3
              FPRIME(I) = FPRIME(I)/DIST(I)
 110   CONTINUE
       RETURN
       END
