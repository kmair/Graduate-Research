      REAL FUNCTION EEBSF(K,T1,N1,A1,T2,N2,A2)
C
C
C PURPOSE - TO ESTIMATE THE ERROR IN A B-SPLINE APPROXIMATION.
C
C MNEMONIC - DOUBLE PRECISION ESTIMATION OF THE ERROR IN A B-SPLIN
C            APPROXIMATION TO A FUNCTION.
C
C METHOD -
C
C   LET (K,T1,N1,A1) REPRESENT AN APPROXIMATION Y1 TO SOME FUNCTIO
C   USING B-SPLINES ON THE MESH T1 WITH COEFFICIENTS A1.
C   LET (K,T2,N2,A2) REPRESENT A REFINEMENT Y2 OF THE (K,T1,N1,A1)
C   APPROXIMATION.
C
C   LET T BE THE UNION OF THE MESHES T1 AND T2.
C
C   LET MEST = (K-1)*PI+1 .
C
C   THE ERROR IN THE (K,T2,N2,A2) APPROXIMATION IS ESTIMATED
C   BY SEARCHING EACH T INTERVAL AT A PATTERN OF MEST POINTS XEST
C
C      MAX(ABS(Y2-Y1))/((H1(I)/H2(I))**K-1)
C
C   WHERE H1(I) IS DEFINED TO BE THE LENGTH OF THE LARGEST MESH IN
C   OF T1 INTERSECTING (T(I),T(I+1)). SIMILARLY FOR H2(I).
C
C   THE PATTERN OF POINTS XEST USED IS COS(THETA) WHERE THE MEST T
C   VALUES ARE UNIFORMLY DISTRIBUTED ON (-PI,0).
C
C   THIS SEARCH PATTERN IS SUFFICIENT TO GUARANTEE THAT THE ERROR
C   ESTIMATE IS COMPUTED ACCURATE TO WITHIN A FACTOR OF 2.
C
C INPUT -
C
C   K    - THE ORDER OF THE B-SPLINES USED.
C          2 .LE. K IS ASSUMED.
C   T1   - THE UNREFINED B-SPLINE MESH.
C   N1   - THE NUMBER OF POINTS IN THE T1 MESH.
C   A1   - THE UNREFINED B-SPLINE COEFFICIENTS.
C   T2   - THE REFINED B-SPLINE MESH.
C   N2   - THE NUMBER OF POINTS IN THE T2 MESH.
C   A2   - THE REFINED B-SPLINE COEFFICIENTS.
C
C OUTPUT -
C
C   PROCEDURE VALUE - THE ESTIMATED ERROR IN Y1.
C
C SCRATCH SPACE ALLOCATED - 5*K + MEST + 2 REAL WORDS.
C
C ERROR STATES -
C
C   1 - K.LT.2.
C   2 - N1.LE.K.
C   3 - N2.LE.K.
C   4 - (T1(1),T1(N1)) IS NOT (T2(1),T2(N2)).
C   5 - T1 NOT MONOTONE INCREASING.
C   6 - T2 NOT MONOTONE INCREASING.
C
      INTEGER I
      REAL X(2),EREST1(2),EREST2(2),EEBSI
      INTEGER K,N1,N2
      REAL T1(N1),A1(1),T2(N2),A2(1)
C
C
C
C REAL A1(N1-K),A2(N2-K)
C
C
C CHECK THE INPUT.
C
      IF( K.GE.2 )      GOTO 1000
C/6S
C     CALL SETERR(15H EEBSF - K.LT.2,15,1,2)
C/7S
      CALL SETERR(' EEBSF - K.LT.2',15,1,2)
C/
 1000 CONTINUE
      IF( N1.GT.K )      GOTO 1002
C/6S
C     CALL SETERR(16H EEBSF - N1.LE.K,16,2,2)
C/7S
      CALL SETERR(' EEBSF - N1.LE.K',16,2,2)
C/
 1002 CONTINUE
      IF( N2.GT.K )      GOTO 1004
C/6S
C     CALL SETERR(16H EEBSF - N2.LE.K,16,3,2)
C/7S
      CALL SETERR(' EEBSF - N2.LE.K',16,3,2)
C/
C
 1004 CONTINUE
      IF( T1(1).EQ.T2(1).AND.T1(N1).EQ.T2(N2) )      GOTO 1006
C/6S
C           CALL SETERR(45H EEBSF - (T1(1),T1(N1)) IS NOT (T2(1),T2(N2))
C    *,45,4,2)
C/7S
            CALL SETERR(' EEBSF - (T1(1),T1(N1)) IS NOT (T2(1),T2(N2))'
     *,45,4,2)
C/
C
 1006 CONTINUE
      I21010 = N1-1
      DO 1008 I = 1, I21010
      IF( T1(I).LE.T1(I+1) )      GOTO 1011
C/6S
C     CALL SETERR(35H EEBSF - T1 NOT MONOTONE INCREASING,35,5,2)
C/7S
      CALL SETERR(' EEBSF - T1 NOT MONOTONE INCREASING',35,5,2)
C/
 1011 CONTINUE
      IF( I+K.LE.N1 )      GOTO 1013
      GOTO 1008
 1013 CONTINUE
      IX1005 = I+K
      IF( T1(IX1005).GT.T1(I) )      GOTO 1015
C/6S
C     CALL SETERR(35H EEBSF - T1 NOT MONOTONE INCREASING,35,5,2)
C/7S
      CALL SETERR(' EEBSF - T1 NOT MONOTONE INCREASING',35,5,2)
C/
 1015 CONTINUE
 1008 CONTINUE
 1009 CONTINUE
      I21019 = N2-1
      DO 1017 I = 1, I21019
      IF( T2(I).LE.T2(I+1) )      GOTO 1020
C/6S
C     CALL SETERR(35H EEBSF - T2 NOT MONOTONE INCREASING,35,6,2)
C/7S
      CALL SETERR(' EEBSF - T2 NOT MONOTONE INCREASING',35,6,2)
C/
 1020 CONTINUE
      IF( I+K.LE.N2 )      GOTO 1022
      GOTO 1017
 1022 CONTINUE
      IX1005 = I+K
      IF( T2(IX1005).GT.T2(I) )      GOTO 1024
C/6S
C     CALL SETERR(35H EEBSF - T2 NOT MONOTONE INCREASING,35,6,2)
C/7S
      CALL SETERR(' EEBSF - T2 NOT MONOTONE INCREASING',35,6,2)
C/
 1024 CONTINUE
C
 1017 CONTINUE
 1018 CONTINUE
      X(1) = T1(1)
      X(2) = T1(N1)
C
      EEBSF = EEBSI(K,T1,N1,A1,T2,N2,A2,X,2,EREST1,EREST2)
      RETURN
C
      END
