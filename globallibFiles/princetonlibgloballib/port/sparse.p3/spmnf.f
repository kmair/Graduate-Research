      SUBROUTINE  SPMNF(N, IWORK, A,  EPS, GROWTH)
      INTEGER N, IWORK(1), JLU
      REAL A(1),  EPS, GROWTH
      REAL DD(1000)
      COMMON /CSTAK/ DD
      INTEGER ID, NERR, ISTKGT, NERROR, ISP(1)
      EQUIVALENCE (DD(1), ISP(1))
C NUMERICAL FACTORIZATION
C INPUT PARAMETERS
C N    ORDER OF MATRIX
C IWORK INTEGER VECTOR OF SYMBOLIC FACTORIZATION COMPUTED BY
C        SPMSF
C EPS     LARGEST NONACCEPTABLE PIVOT FOR SINGULARITY TEST
C A       VECTOR COMPUTED BY  SPMIN ACCORDING TO INSTRUCTIONS
C         GIVEN IN  SPMSF
C OUTPUT PARAMETERS
C A     NUMERICAL FACTORIZATION OF MATRIX
C GROWTH NUMERICAL ELEMENT GROWTH. IF THIS MUCH .GT. 1, THEN THE
C        COMPUTED DECOMPOSITION MAY BE THE DECOMPOSITION OF A MATRIX
C        THAT IS NOT VERY CLOSE TO THE ORIGINAL MATRIX.
C STORAGE ALLOCATED -N REAL LOCATION WHICH
C       ARE RETURNED
C ERROR STATES
C 1   N.LT.1     FATAL
C 10+K SINGULAR MATRIX OF RANK K   RECOVERABLE
C/6S
C     IF (N .LT. 1) CALL SETERR(13H SPMNF-N.LT.1, 13, 1, 2)
C/7S
      IF (N .LT. 1) CALL SETERR(' SPMNF-N.LT.1', 13, 1, 2)
C/
      CALL ENTER(1)
      ID = ISTKGT(N, 3)
       JLU=2*N+2
       CALL  S4MNF(N,IWORK,IWORK(N+2),IWORK(JLU),A,DD(ID),GROWTH,EPS)
C/6S
C     IF (NERROR(NERR) .NE. 0) CALL N5ERR(22H SPMNF-SINGULAR MATRIX, 22,
C    1   NERR, 1)
C/7S
      IF (NERROR(NERR) .NE. 0) CALL N5ERR(' SPMNF-SINGULAR MATRIX', 22,
     1   NERR, 1)
C/
      CALL LEAVE
      RETURN
      END
