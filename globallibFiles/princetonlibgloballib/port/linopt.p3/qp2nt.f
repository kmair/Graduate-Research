        SUBROUTINE QP2NT(ITER,N,M,X,A,IA,B,F,RELDF,RELDX,JT,JSIM,IT,
     1  IAC,IDROP,IADD,POSDEF,BU)
        INTEGER ITER,N,IA,JT,IT,IDROP,IADD
        INTEGER PU,M
        INTEGER JSIM(N),IAC(M)
        REAL X(N),A(IA,N),B(M),F,RELDF,RELDX,BU(N)
        LOGICAL POSDEF
        REAL RNEG,R,SNRM2
        PU=I1MACH(2)
        IF (.NOT.POSDEF)WRITE(PU,99)
 99      FORMAT(29H INDEFINITE PROJECTED HESSIAN)
        IF (ITER.GT.1) GO TO 9
         WRITE(PU,599)
 599     FORMAT(22H FEASIBLE POINT FOUND )
         WRITE(PU,699)(X(I),I=1,N)
 699     FORMAT(1H ,5E15.5)
      IF (IT .LE. 0) GOTO 4
         WRITE (PU,  1)
   1     FORMAT (21HEQUALITY CONSTRAINTS )
         DO  3 I = 1, IT
            WRITE (PU,  2) IAC(I)
   2        FORMAT (I10)
   3        CONTINUE
   4  JTP1 = JT+1
      IF (JT .GE. N) GOTO 8
         WRITE (PU,  5)
   5     FORMAT (25H COORDINATES AT BOUNDARY )
         DO  7 I = JTP1, N
            WRITE (PU,  6) JSIM(I)
   6        FORMAT (I10)
   7        CONTINUE
   8     CONTINUE
       WRITE(PU,199)
 199    FORMAT(49H ITERATION  F   RELDF     RELDX  DROPPED    ADDED)
       WRITE(PU,299)
 299   FORMAT(52H                               CONSTRAINT CONSTRAINT)
 9     CONTINUE
        IDR=IABS(IDROP)
        IAD=IABS(IADD)
        IF (IDROP)81,499,41
 499    IF (IAD.EQ.0)WRITE(PU,10)ITER,F,RELDF,RELDX
 10       FORMAT(I3,1X,3E10.3)
        IF (IADD.GT.0)
     1   WRITE(PU,20)ITER,F,RELDF,RELDX,IAD
 20      FORMAT(I3,1X,3E10.3,6X,I3,1HG)
        IF (IADD.LT.0.AND.X(IAD).EQ.BU(IAD))
     1     WRITE(PU,30)ITER,F,RELDF,RELDX,IAD
 30      FORMAT(I3,1X,3E10.3,6X,I3,1HU)
        IF (IADD.LT.0.AND.X(IAD).NE.BU(IAD))
     1     WRITE(PU,40)ITER,F,RELDF,RELDX,IAD
 40      FORMAT(I3,1X,3E10.3,6X,I3,1HL)
         GO TO 161
 41      CONTINUE
        IF (IAD.EQ.0)
     1WRITE(PU,50)ITER,F,RELDF,RELDX,IDR
 50      FORMAT(I3,1X,3E10.3,1X,I3,1HG)
        IF (IADD.GT.0)
     1     WRITE(PU,60)ITER,F,RELDF,RELDX,IDR,IAD
 60      FORMAT(I3,1X,3E10.3,1X,I3,1HG,1X,I3,1HG)
        IF (IADD.LT.0.AND.X(IAD).EQ.BU(IAD))
     1     WRITE(PU,70)ITER,F,RELDF,RELDX,IDR,IAD
 70      FORMAT(I3,1X,3E10.3,1X,I3,1HG,1X,I3,1HU)
        IF (IADD.LT.0.AND.X(IAD).NE.BU(IAD))
     1     WRITE(PU,80)ITER,F,RELDF,RELDX,IDR,IAD
 80      FORMAT(I3,1X,3E10.3,1X,I3,1HG,1X,I3,1HL)
         GO TO 161
 81      CONTINUE
         IF (X(IDR).NE.BU(IDR))GO TO 121
         IF (IAD.EQ.0)
     1     WRITE(PU,90)ITER,F,RELDF,RELDX,IDR
 90      FORMAT(I3,1X,3E10.3,1X,I3,1HU)
         IF (IADD.GT.0)
     1     WRITE(PU,100)ITER,F,RELDF,RELDX,IDR,IAD
 100       FORMAT(I3,1X,3E10.3,1X,I3,1HU,1X,I3,1HG)
         IF (IADD.LT.0.AND.X(IAD).EQ.BU(IAD))
     1     WRITE(PU,110)ITER,F,RELDF,RELDX,IDR,IAD
 110       FORMAT(I3,1X,3E10.3,1X,I3,1HU,1X,I3,1HU)
         IF (IADD.LT.0.AND.X(IAD).LT.BU(IAD))
     1     WRITE(PU,120)ITER,F,RELDF,RELDX,IDR,IAD
 120       FORMAT(I3,1X,3E10.3,1X,I3,1HU,1X,I3,1HL)
         GO TO 161
 121     CONTINUE
         IF (IAD.EQ.0)
     1     WRITE(PU,130)ITER,F,RELDF,RELDX,IDR
 130       FORMAT(I3,1X,3E10.3,1X,I3,1HL)
         IF (IADD.GT.0)
     1     WRITE(PU,140)ITER,F,RELDF,RELDX,IDR,IAD
 140       FORMAT(I3,1X,3E10.3,1X,I3,1HL,1X,I3,1HG)
         IF (IADD.LT.0.AND.X(IAD).EQ.BU(IAD))
     1     WRITE(PU,150)ITER,F,RELDF,RELDX,IDR,IAD
 150       FORMAT(I3,1X,3E10.3,1X,I3,1HL,1X,I3,1HU)
         IF (IADD.LT.0.AND.X(IAD).NE.BU(IAD))
     1     WRITE(PU,160)ITER,F,RELDF,RELDX,IDR,IAD
 160       FORMAT(I3,1X,3E10.3,1X,I3,1HL,1X,I3,1HL)
 161      CONTINUE
       IF (M.EQ.0)RETURN
       RNEG=0.0E0
       DO 200 I=1,M
        R=-DBLE(B(I))
        DO 180 J=1,N
         R=R+DBLE(A(I,J))*DBLE(X(J))
 180    CONTINUE
        IF (R.GE.0.0E0) GO TO 200
        R=R/SNRM2(N,A(I,1),IA)
        IF (R.GT.RNEG) GO TO 200
         RNEG=R
         IR=I
 200   CONTINUE
       IF (RNEG.GT.(-1000.0)*R1MACH(4)) RETURN
       WRITE(PU,210)IR,RNEG
 210  FORMAT(19H WARNING CONSTRAINT,I3,29H IS MOST VIOLATED CONSTRAINT ,
     122HWITH RELATIVE RESIDUAL,E10.3)
      RETURN
      END
